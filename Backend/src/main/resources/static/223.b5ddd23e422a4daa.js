"use strict";(self.webpackChunkmantis_free_version=self.webpackChunkmantis_free_version||[]).push([[223],{223:(M,c,a)=>{a.r(c),a.d(c,{UsersComponent:()=>v});var p=a(5779);class u{constructor(d,s,o,r,n,t){this.id=d,this.name=s,this.username=o,this.email=r,this.password=n,this.roles=t}}var m=a(2228),g=a(1360),h=a(177),i=a(4341),e=a(3953),b=a(6128),F=a(1626);let U=(()=>{class l{constructor(s){this.http=s,this.baseUrl="http://localhost:6800/role"}getRole(){return this.http.get(`${this.baseUrl}/get`)}static{this.\u0275fac=function(o){return new(o||l)(e.KVO(F.Qq))}}static{this.\u0275prov=e.jDH({token:l,factory:l.\u0275fac,providedIn:"root"})}}return l})();function f(l,d){if(1&l){const s=e.RV6();e.j41(0,"tr")(1,"td",15),e.EFF(2),e.k0s(),e.j41(3,"td",15),e.EFF(4),e.k0s(),e.j41(5,"td",15),e.EFF(6),e.k0s(),e.j41(7,"td",15)(8,"button",42),e.bIt("click",function(){const r=e.eBV(s).$implicit,n=e.XpG();return e.Njj(n.openEditUserModal(r))}),e.nrm(9,"i",43),e.k0s(),e.j41(10,"button",44),e.bIt("click",function(){const r=e.eBV(s).$implicit,n=e.XpG();return e.Njj(n.deleteUser(r.id))}),e.nrm(11,"i",45),e.k0s()()()}if(2&l){const s=d.$implicit,o=e.XpG();e.R7$(2),e.JRh(s.username),e.R7$(2),e.JRh(s.email),e.R7$(2),e.JRh(o.roleNames(s.roles))}}function j(l,d){if(1&l&&(e.j41(0,"option",46),e.EFF(1),e.k0s()),2&l){const s=d.$implicit;e.Y8G("value",s.name),e.R7$(),e.JRh(s.name)}}function E(l,d){if(1&l&&(e.j41(0,"option",46),e.EFF(1),e.k0s()),2&l){const s=d.$implicit;e.Y8G("value",s.name),e.R7$(),e.JRh(s.name)}}let v=(()=>{class l{constructor(s,o,r){this.userController=s,this.roleController=o,this.messageService=r,this.users=[],this.Roles=[],this.user=new u(null,"","","","",[]),this.selectedUser=new u(null,"","","","",[]),this.selectedRole=null}ngOnInit(){this.getAlluser(),this.getRole()}getAlluser(){this.userController.getUser().subscribe(s=>{console.log("Donn\xe9es re\xe7ues:",s),this.users=s.map(o=>{const r=new u(o.id,o.name,o.username,o.email,o.password,o.roles);return console.log("Utilisateur cr\xe9\xe9:",r),r})},s=>{this.messageService.add({severity:"error",summary:"Erreur",detail:"Erreur lors du chargement des Users"}),console.error("Erreur de r\xe9cup\xe9ration des utilisateurs",s)})}roleNames(s){return s.map(o=>o.name).join(", ")}getRole(){this.roleController.getRole().subscribe(s=>{this.Roles=s},s=>{this.messageService.add({severity:"error",summary:"Erreur",detail:"Erreur lors du chargement des Roles"}),console.error("Erreur lors du chargement des roles",s)})}addUser(){this.user.roles=this.selectedRole?[{name:this.selectedRole}]:[],console.log("Ajout de l'utilisateur :",this.user),this.userController.addUser(this.user).subscribe(s=>{this.users.push(s),console.log("Utilisateur ajout\xe9 avec succ\xe8s",s),this.resetForm();const o=document.getElementById("addUserModalLabel");o&&(m.aF.getInstance(o)||new m.aF(o)).hide();const r=document.querySelector(".modal-backdrop");r&&r.remove(),document.body.classList.remove("modal-open"),document.body.style.overflow="",document.body.style.paddingRight="",this.messageService.add({severity:"success",summary:"Succ\xe8s",detail:"l'utilisateur ajout\xe9e avec succ\xe8s"})},s=>{this.messageService.add({severity:"error",summary:"Erreur",detail:"Erreur lors de l'ajout de l'utilisateur"}),console.error("Erreur lors de l'ajout de l'utilisateur",s)})}resetForm(){this.user=new u(0,"","","","",[])}openEditUserModal(s){s&&s.id?(this.selectedUser={...s},this.selectedRole=s.roles.length>0?s.roles[0].name:null,console.log("Utilisateur s\xe9lectionn\xe9 pour modification:",this.selectedUser),new m.aF(document.getElementById("EditUserModalLabel")).show()):console.error("Aucun utilisateur s\xe9lectionn\xe9 ou ID manquant pour la modification.")}updateUser(){this.selectedUser&&this.selectedUser.id?(this.selectedUser.roles=[{name:this.selectedRole}],this.userController.updateUser(this.selectedUser).subscribe(()=>{this.messageService.add({severity:"success",summary:"Succ\xe8s",detail:"l'utilisateur mise \xe0 jour avec succ\xe8s"}),this.getAlluser();const s=m.aF.getInstance(document.getElementById("EditUserModalLabel"));s&&s.hide()},s=>{this.messageService.add({severity:"error",summary:"Erreur",detail:"Erreur lors de la mise \xe0 jour de l'utilisateur"}),console.error("Erreur lors de la mise \xe0 jour de l'utilisateur",s)})):console.error("Aucun utilisateur s\xe9lectionn\xe9 ou ID manquant pour la mise \xe0 jour")}deleteUser(s){confirm("\xcates-vous s\xfbr de vouloir supprimer cette user ?")&&this.userController.deleteUser(s).subscribe(()=>{this.messageService.add({severity:"success",summary:"Succ\xe8s",detail:"l'utilisateur supprim\xe9e avec succ\xe8s"}),console.log("User supprim\xe9e avec succ\xe8s"),this.getAlluser()},o=>{console.error("Erreur lors de la suppression de user",o)})}static{this.\u0275fac=function(o){return new(o||l)(e.rXU(b.S),e.rXU(U),e.rXU(p.bg))}}static{this.\u0275cmp=e.VBU({type:l,selectors:[["app-users"]],standalone:!0,features:[e.Jv_([p.bg]),e.aNF],decls:105,vars:13,consts:[["rel","stylesheet","href",e.wXG`https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css`],["rel","stylesheet","href",e.wXG`https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css`],[1,"container"],[1,"row",2,"background-color","rgba(255, 255, 255, 0.8)","border","2px solid #aaaf00","border-radius","10px"],[1,"col-12"],[1,"border","border-1","border-light","bg-white","p-3",2,"border-radius","10px"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],["data-bs-toggle","modal","data-bs-target","#addUserModalLabel",1,"btn","btn-primary"],[1,"ms-2"],[1,"bi","bi-plus"],[1,"mb-4"],[1,"col-md-12","col-xl-12"],[1,"card","tbl-card"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"text-center"],[4,"ngFor","ngForOf"],["id","addUserModalLabel","tabindex","-1","aria-labelledby","addUserModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","addUserModalLabel",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],["id","userForm"],[1,"mb-3"],["for","userName",1,"form-label"],["type","text","id","userName","name","userName","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","userUsername",1,"form-label"],["type","text","id","userUsername","name","userUsername","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","userEmail",1,"form-label"],["type","email","id","userEmail","name","userEmail","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","userPassword",1,"form-label"],["type","password","id","userPassword","name","userPassword","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","userRoles",1,"form-label"],["id","userRoles","name","userRoles","required","",1,"form-select",3,"ngModelChange","ngModel"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button","id","saveUser",1,"btn","btn-primary",3,"click"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],["id","EditUserModalLabel","tabindex","-1","aria-labelledby","EditUserModalLabel","aria-hidden","true",1,"modal","fade"],[1,"btn","btn-sm","btn-warning",2,"border-radius","60px",3,"click"],[1,"bi","bi-pencil-square"],[1,"btn","btn-sm","btn-danger","ms-2",2,"border-radius","60px",3,"click"],[1,"bi","bi-x-octagon"],[3,"value"]],template:function(o,r){1&o&&(e.nrm(0,"link",0)(1,"link",1)(2,"p-toast"),e.j41(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6)(8,"h3"),e.EFF(9,"Ajouter User "),e.k0s(),e.j41(10,"button",7),e.EFF(11," Ajouter "),e.j41(12,"span",8),e.nrm(13,"i",9),e.k0s()()()()()(),e.nrm(14,"div",10),e.j41(15,"div",11)(16,"div",12)(17,"div",13)(18,"table",14)(19,"thead")(20,"tr")(21,"th",15),e.EFF(22,"Nom User"),e.k0s(),e.j41(23,"th",15),e.EFF(24,"Mail"),e.k0s(),e.j41(25,"th",15),e.EFF(26,"Role"),e.k0s(),e.j41(27,"th",15),e.EFF(28,"Actions"),e.k0s()()(),e.j41(29,"tbody"),e.DNE(30,f,12,3,"tr",16),e.k0s()()()()(),e.j41(31,"div",17)(32,"div",18)(33,"div",19)(34,"div",20)(35,"h5",21),e.EFF(36,"Ajouter Utilisateur"),e.k0s(),e.nrm(37,"button",22),e.k0s(),e.j41(38,"div",23)(39,"form",24)(40,"div",25)(41,"label",26),e.EFF(42,"Nom"),e.k0s(),e.j41(43,"input",27),e.mxI("ngModelChange",function(t){return e.DH7(r.user.name,t)||(r.user.name=t),t}),e.k0s()(),e.j41(44,"div",25)(45,"label",28),e.EFF(46,"Nom d'utilisateur"),e.k0s(),e.j41(47,"input",29),e.mxI("ngModelChange",function(t){return e.DH7(r.user.username,t)||(r.user.username=t),t}),e.k0s()(),e.j41(48,"div",25)(49,"label",30),e.EFF(50,"Email"),e.k0s(),e.j41(51,"input",31),e.mxI("ngModelChange",function(t){return e.DH7(r.user.email,t)||(r.user.email=t),t}),e.k0s()(),e.j41(52,"div",25)(53,"label",32),e.EFF(54,"Mot de passe"),e.k0s(),e.j41(55,"input",33),e.mxI("ngModelChange",function(t){return e.DH7(r.user.password,t)||(r.user.password=t),t}),e.k0s()(),e.j41(56,"div",25)(57,"label",34),e.EFF(58,"R\xf4le"),e.k0s(),e.j41(59,"select",35),e.mxI("ngModelChange",function(t){return e.DH7(r.selectedRole,t)||(r.selectedRole=t),t}),e.j41(60,"option",36),e.EFF(61,"S\xe9lectionnez un r\xf4le"),e.k0s(),e.DNE(62,j,2,2,"option",37),e.k0s()()()(),e.j41(63,"div",38)(64,"button",39),e.bIt("click",function(){return r.addUser()}),e.EFF(65,"Ajouter"),e.k0s(),e.j41(66,"button",40),e.EFF(67,"Fermer"),e.k0s()()()()(),e.j41(68,"div",41)(69,"div",18)(70,"div",19)(71,"div",20)(72,"h5",21),e.EFF(73,"Ajouter Utilisateur"),e.k0s(),e.nrm(74,"button",22),e.k0s(),e.j41(75,"div",23)(76,"form",24)(77,"div",25)(78,"label",26),e.EFF(79,"Nom"),e.k0s(),e.j41(80,"input",27),e.mxI("ngModelChange",function(t){return e.DH7(r.selectedUser.name,t)||(r.selectedUser.name=t),t}),e.k0s()(),e.j41(81,"div",25)(82,"label",28),e.EFF(83,"Nom d'utilisateur"),e.k0s(),e.j41(84,"input",29),e.mxI("ngModelChange",function(t){return e.DH7(r.selectedUser.username,t)||(r.selectedUser.username=t),t}),e.k0s()(),e.j41(85,"div",25)(86,"label",30),e.EFF(87,"Email"),e.k0s(),e.j41(88,"input",31),e.mxI("ngModelChange",function(t){return e.DH7(r.selectedUser.email,t)||(r.selectedUser.email=t),t}),e.k0s()(),e.j41(89,"div",25)(90,"label",32),e.EFF(91,"Mot de passe"),e.k0s(),e.j41(92,"input",33),e.mxI("ngModelChange",function(t){return e.DH7(r.selectedUser.password,t)||(r.selectedUser.password=t),t}),e.k0s()(),e.j41(93,"div",25)(94,"label",34),e.EFF(95,"R\xf4le"),e.k0s(),e.j41(96,"select",35),e.mxI("ngModelChange",function(t){return e.DH7(r.selectedRole,t)||(r.selectedRole=t),t}),e.j41(97,"option",36),e.EFF(98,"S\xe9lectionnez un r\xf4le"),e.k0s(),e.DNE(99,E,2,2,"option",37),e.k0s()()()(),e.j41(100,"div",38)(101,"button",39),e.bIt("click",function(){return r.updateUser()}),e.EFF(102,"Ajouter"),e.k0s(),e.j41(103,"button",40),e.EFF(104,"Fermer"),e.k0s()()()()()()),2&o&&(e.R7$(30),e.Y8G("ngForOf",r.users),e.R7$(13),e.R50("ngModel",r.user.name),e.R7$(4),e.R50("ngModel",r.user.username),e.R7$(4),e.R50("ngModel",r.user.email),e.R7$(4),e.R50("ngModel",r.user.password),e.R7$(4),e.R50("ngModel",r.selectedRole),e.R7$(3),e.Y8G("ngForOf",r.Roles),e.R7$(18),e.R50("ngModel",r.selectedUser.name),e.R7$(4),e.R50("ngModel",r.selectedUser.username),e.R7$(4),e.R50("ngModel",r.selectedUser.email),e.R7$(4),e.R50("ngModel",r.selectedUser.password),e.R7$(4),e.R50("ngModel",r.selectedRole),e.R7$(3),e.Y8G("ngForOf",r.Roles))},dependencies:[g.MB,g.y8,h.MD,h.Sq,i.YN,i.qT,i.xH,i.y7,i.me,i.wz,i.BC,i.cb,i.YS,i.vS,i.cV]})}}return l})()}}]);